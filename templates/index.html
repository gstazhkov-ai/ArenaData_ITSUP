<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è —Å–ª—É–∂–±—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏</title>
    <style>
        :root {
            --primary: #2563eb;       
            --secondary: #475569;     
            --accent: #0ea5e9;        
            --success: #10b981;       
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --border: #e2e8f0;
        }

        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: var(--bg); color: var(--text); line-height: 1.6; margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }

        /* HEADER */
        header { background: linear-gradient(135deg, #1e293b, #334155); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px; position: relative; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        header h1 { margin: 0; font-size: 2rem; }
        header p { margin: 10px 0 0; opacity: 0.9; font-size: 1.1rem; }
        .auth-controls { position: absolute; top: 25px; right: 25px; display: flex; gap: 10px; }
        .btn-auth { padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 0.85rem; font-weight: 600; border: 1px solid rgba(255,255,255,0.3); transition: 0.2s; color: white; background: rgba(255,255,255,0.1); }
        .btn-auth:hover { background: rgba(255,255,255,0.25); }
        #logoutBtn { display: none; background: rgba(239, 68, 68, 0.25); border-color: rgba(239, 68, 68, 0.5); }
        #loginBtn { display: block; }
        body.is-admin #loginBtn { display: none; }
        body.is-admin #logoutBtn { display: block; }

        /* DASHBOARD METRICS */
        .dashboard-section { margin-bottom: 40px; }
        .dash-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .dash-title { font-size: 1.4rem; font-weight: 700; color: var(--secondary); display: flex; align-items: center; gap: 10px; }
        .yandex-badge { background: #fc0; color: #000; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; }
        
        .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; }
        
        .kpi-card { background: white; border-radius: 12px; padding: 15px 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-top: 4px solid var(--primary); position: relative; }
        .kpi-value { font-size: 2.2rem; font-weight: 800; color: var(--text); line-height: 1.2; }
        .kpi-label { font-size: 0.85rem; color: var(--secondary); margin-top: 5px; text-transform: uppercase; font-weight: 600; }
        .kpi-date { font-size: 0.75rem; color: #94a3b8; margin-top: 10px; border-top: 1px solid #f1f5f9; padding-top: 8px; }

        .edit-metrics-btn { display: none; background: var(--primary); color: white; border: none; padding: 6px 15px; border-radius: 6px; cursor: pointer; }
        body.is-admin .edit-metrics-btn { display: block; }

        /* MODAL */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; }
        .modal { background: white; padding: 30px; border-radius: 12px; width: 450px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 600; font-size: 0.9rem; color: var(--secondary); }
        .form-group input { width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; box-sizing: border-box; }
        .modal-actions { display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px; }
        .btn-cancel, .btn-save { padding: 8px 16px; border-radius: 6px; cursor: pointer; border: none; }
        .btn-cancel { background: #e2e8f0; color: var(--text); }
        .btn-save { background: var(--primary); color: white; }

        /* CONTENT STYLES */
        .section-title { border-left: 5px solid var(--primary); padding-left: 15px; margin: 40px 0 20px 0; color: var(--secondary); font-size: 1.5rem; font-weight: 700; }
        
        .gantt-wrapper { background: var(--card-bg); padding: 20px; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); overflow-x: auto; margin-bottom: 30px; border: 1px solid var(--border); }
        .gantt-grid { display: grid; grid-template-columns: 250px repeat(6, 1fr); gap: 1px; background-color: var(--border); border: 1px solid var(--border); min-width: 800px; }
        .gantt-header, .gantt-cell { background-color: white; padding: 10px; font-size: 0.9rem; display: flex; align-items: center; }
        .gantt-header { font-weight: bold; background-color: #f1f5f9; justify-content: center; }
        .gantt-task { font-weight: 600; justify-content: flex-start; padding-left: 15px; }
        .bar-container { grid-column: 2 / span 6; background: white; position: relative; height: 40px; }
        .bar { position: absolute; height: 24px; top: 8px; border-radius: 4px; color: white; font-size: 0.75rem; display: flex; align-items: center; padding-left: 10px; white-space: nowrap; overflow: hidden; }
        .bar.phase1 { background: #ef4444; left: 0%; width: 33%; }
        .bar.phase2 { background: #3b82f6; left: 33%; width: 33%; }
        .bar.phase3 { background: #10b981; left: 66%; width: 34%; }

        /* Tables & SLA */
        .phase-card { background: var(--card-bg); border-radius: 12px; padding: 25px; margin-bottom: 20px; border: 1px solid var(--border); }
        .phase-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 2px solid #f1f5f9; padding-bottom: 10px; }
        .phase-title { font-size: 1.2rem; font-weight: 700; color: var(--primary); }
        .phase-meta { font-size: 0.85rem; color: var(--secondary); background: #f1f5f9; padding: 4px 10px; border-radius: 20px; font-weight: 600; }
        table { width: 100%; border-collapse: collapse; font-size: 0.95rem; }
        th { text-align: left; background: #f8fafc; padding: 12px; color: var(--secondary); font-weight: 600; border-bottom: 2px solid var(--border); }
        td { padding: 12px; border-bottom: 1px solid #f1f5f9; vertical-align: top; }
        
        /* SLA Table specific */
        .sla-table th { background: #e0f2fe; color: #0369a1; }
        .priority-high { color: #dc2626; font-weight: bold; }
        .priority-med { color: #d97706; font-weight: bold; }

        .okr-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(480px, 1fr)); gap: 20px; }
        .okr-box { background: #fff; border-left: 5px solid var(--accent); border-radius: 8px; padding: 25px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); display: flex; flex-direction: column; }
        .okr-box h3 { margin-top: 0; color: var(--text); display: flex; align-items: center; gap: 10px; }
        .steps-list { list-style: none; padding: 0; margin: 15px 0; flex-grow: 1; }
        .steps-list li { position: relative; padding-left: 20px; margin-bottom: 12px; font-size: 0.95rem; }
        .steps-list li::before { content: "‚Ä¢"; color: var(--accent); font-weight: bold; position: absolute; left: 0; top: 0; }
        
        .file-zone { margin-top: 20px; padding-top: 15px; border-top: 1px dashed var(--border); background: #fafbfc; border-radius: 0 0 8px 8px; padding: 15px; }
        .file-list { list-style: none; padding: 0; margin: 10px 0; font-size: 0.85rem; }
        .file-list li { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; background: white; padding: 6px 10px; border: 1px solid var(--border); border-radius: 4px; }
        .file-list a { text-decoration: none; color: var(--primary); font-weight: 500; }
        
        .admin-only { display: none !important; }
        body.is-admin .admin-only { display: flex !important; }
        .delete-btn { display: none; color: #ef4444; cursor: pointer; font-weight: bold; margin-left: 10px; }
        body.is-admin .delete-btn { display: block; }
        .upload-controls { gap: 10px; align-items: center; margin-top: 10px; }
        button.upload-btn { background: var(--primary); color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer; font-size: 0.85rem; font-weight: 600; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è —Å–ª—É–∂–±—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏</h1>
        <p>–î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞, SLA –∏ –ú–µ—Ç—Ä–∏–∫–∏</p>
        <div class="auth-controls">
            <button class="btn-auth" id="loginBtn" onclick="loginAdmin()">üîê –ê–¥–º–∏–Ω –í—Ö–æ–¥</button>
            <button class="btn-auth" id="logoutBtn" onclick="logoutAdmin()">üö™ –í—ã–π—Ç–∏</button>
        </div>
    </header>

    <div class="dashboard-section">
        <div class="dash-header">
            <div class="dash-title">üìä –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ IT Support <span class="yandex-badge">Yandex Tracker</span></div>
            <button class="edit-metrics-btn" onclick="openMetricsModal()">‚úèÔ∏è –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
        </div>

        <div class="metrics-grid">
            <div class="kpi-card" style="border-top-color: #2563eb;">
                <div class="kpi-value" id="val-tickets">...</div>
                <div class="kpi-label">–û—Ç–∫—Ä—ã—Ç—ã–µ –∑–∞—è–≤–∫–∏</div>
                <div class="kpi-date">–ê–∫—Ç—É–∞–ª—å–Ω–æ: <span class="val-date">-</span></div>
            </div>
            <div class="kpi-card" style="border-top-color: #10b981;">
                <div class="kpi-value" id="val-sla">...</div>
                <div class="kpi-label">SLA (–°—Ä–æ–∫–∏)</div>
                <div class="kpi-date">–¶–µ–ª—å: > 95%</div>
            </div>
            <div class="kpi-card" style="border-top-color: #0ea5e9;">
                <div class="kpi-value" id="val-csat">...</div>
                <div class="kpi-label">CSAT (–û—Ü–µ–Ω–∫–∞)</div>
                <div class="kpi-date">–¶–µ–ª—å: 5.0</div>
            </div>
            <div class="kpi-card" style="border-top-color: #8b5cf6;">
                <div class="kpi-value" id="val-fcr">...</div>
                <div class="kpi-label">FCR (–° 1-–≥–æ —Ä–∞–∑–∞)</div>
                <div class="kpi-date">–¶–µ–ª—å: > 75%</div>
            </div>
            <div class="kpi-card" style="border-top-color: #ef4444;">
                <div class="kpi-value" id="val-incidents">...</div>
                <div class="kpi-label">–î–æ–ª—è –ò–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤</div>
                <div class="kpi-date">–¶–µ–ª—å: < 20%</div>
            </div>
            <div class="kpi-card" style="border-top-color: #f59e0b;">
                <div class="kpi-value" id="val-time">...</div>
                <div class="kpi-label">–°—Ä. –≤—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏—è</div>
                <div class="kpi-date">–ß–∞—Å—ã</div>
            </div>
        </div>
    </div>

    <h2 class="section-title">1. –ì—Ä–∞—Ñ–∏–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (Roadmap)</h2>
    <div class="gantt-wrapper">
        <div class="gantt-grid">
            <div class="gantt-cell gantt-header">–≠—Ç–∞–ø / –ú–µ—Å—è—Ü</div>
            <div class="gantt-cell gantt-header">–ú1</div><div class="gantt-cell gantt-header">–ú2</div>
            <div class="gantt-cell gantt-header">–ú3</div><div class="gantt-cell gantt-header">–ú4</div>
            <div class="gantt-cell gantt-header">–ú5</div><div class="gantt-cell gantt-header">–ú6</div>

            <div class="gantt-cell gantt-task">1. –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è</div>
            <div class="bar-container"><div class="bar phase1">–ê—É–¥–∏—Ç ‚Ä¢ VPN ‚Ä¢ –ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è</div></div>

            <div class="gantt-cell gantt-task">2. –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è</div>
            <div class="bar-container"><div class="bar phase2">–†–µ–≥–ª–∞–º–µ–Ω—Ç—ã ‚Ä¢ –ë–ó ‚Ä¢ SLA</div></div>

            <div class="gantt-cell gantt-task">3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</div>
            <div class="bar-container"><div class="bar phase3">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ‚Ä¢ –†–∞–∑–≤–∏—Ç–∏–µ</div></div>
        </div>
    </div>

    <h2 class="section-title">2. –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á –ø–æ —ç—Ç–∞–ø–∞–º</h2>

    <div class="phase-card">
        <div class="phase-header"><div class="phase-title">–≠—Ç–∞–ø 1: –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –∏ –ê—É–¥–∏—Ç</div><div class="phase-meta">–ú–µ—Å—è—Ü—ã 1-2</div></div>
        <table>
            <tr><th width="30%">–ó–∞–¥–∞—á–∞</th><th>–î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π</th><th width="15%">–°—Ä–æ–∫</th></tr>
            <tr>
                <td><strong>1.1. –ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ –∏ –ê—É–¥–∏—Ç</strong></td>
                <td>–ü—Ä–æ–≤–µ—Å—Ç–∏ 1-on-1 –≤—Å—Ç—Ä–µ—á–∏. –í—ã—è–≤–∏—Ç—å –±–æ–ª–∏. –†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–æ–Ω—ã (SaaS/–ñ–µ–ª–µ–∑–æ). –ê–Ω–∞–ª–∏–∑ Tracker (–∏—Å—Ç–æ—Ä–∏—è).</td>
                <td>–ù–µ–¥–µ–ª—è 1</td>
            </tr>
            <tr>
                <td><strong>1.2. –ê–Ω–∞–ª–∏–∑ –Ω–∞–≥—Ä—É–∑–∫–∏</strong></td>
                <td>–í—ã—è–≤–∏—Ç—å –¢–û–ü-5 —á–∞—Å—Ç—ã—Ö –ø—Ä–æ–±–ª–µ–º. –û—Ü–µ–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞—è–≤–æ–∫ (~50/–Ω–µ–¥). –í—ã—è–≤–∏—Ç—å —Å–∫—Ä—ã—Ç—ã–π IT.</td>
                <td>–ù–µ–¥–µ–ª–∏ 1-3</td>
            </tr>
            <tr>
                <td><strong>1.3. –°—Ä–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ VPN</strong></td>
                <td>–°–æ–±—Ä–∞—Ç—å –∂–∞–ª–æ–±—ã. –í—ã–±—Ä–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ (OpenVPN/WireGuard/Enterprise). –ü–∏–ª–æ—Ç–Ω—ã–π –∑–∞–ø—É—Å–∫ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è.</td>
                <td>–ù–µ–¥–µ–ª–∏ 2-4</td>
            </tr>
            <tr>
                <td><strong>1.4. –ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è</strong></td>
                <td>–ü–æ–ª–Ω—ã–π —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Å—á–µ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–µ—Å—Ç—Ä–∞ –∞–∫—Ç–∏–≤–æ–≤. –°–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–≥–æ –ü–û.</td>
                <td>–ù–µ–¥–µ–ª–∏ 2-6</td>
            </tr>
        </table>
    </div>

    <div class="phase-card">
        <div class="phase-header"><div class="phase-title">–≠—Ç–∞–ø 2: –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –∏ SLA</div><div class="phase-meta">–ú–µ—Å—è—Ü—ã 2-4</div></div>
        <p style="margin-bottom: 15px;">–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –ú–∞—Ç—Ä–∏—Ü—ã –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã (–∏–∑ —Ä–∞—Å—á–µ—Ç–∞ 3 —á–µ–ª / 50 –∑–∞—è–≤–æ–∫ –≤ –Ω–µ–¥–µ–ª—é).</p>
        
        <table class="sla-table" style="margin-bottom: 20px; border: 2px solid #e2e8f0;">
            <tr>
                <th>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</th>
                <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                <th>–†–µ–∞–∫—Ü–∏—è</th>
                <th>–†–µ—à–µ–Ω–∏–µ</th>
            </tr>
            <tr>
                <td class="priority-high">üî• –ë–ª–æ–∫–µ—Ä (Blocker)</td>
                <td>–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–∑–Ω–µ—Å–∞ (–ò–Ω—Ç–µ—Ä–Ω–µ—Ç, 1C, –ü–æ—á—Ç–∞ —É –≤—Å–µ—Ö).</td>
                <td>15 –º–∏–Ω</td>
                <td>2-4 —á–∞—Å–∞</td>
            </tr>
            <tr>
                <td class="priority-high">üî¥ –í—ã—Å–æ–∫–∏–π (Critical)</td>
                <td>–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ü–ö —É VIP, –°–∫–ª–∞–¥, VPN —É –æ—Ç–¥–µ–ª–∞ –ø—Ä–æ–¥–∞–∂.</td>
                <td>30 –º–∏–Ω</td>
                <td>8 —á–∞—Å–æ–≤</td>
            </tr>
            <tr>
                <td class="priority-med">üü° –°—Ä–µ–¥–Ω–∏–π (Normal)</td>
                <td>–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ü–û, —Å–æ–∑–¥–∞–Ω–∏–µ —É—á–µ—Ç–∫–∏, –º—ã—à–∫–∞/–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞.</td>
                <td>2 —á–∞—Å–∞</td>
                <td>3 –¥–Ω—è</td>
            </tr>
            <tr>
                <td>üü¢ –ù–∏–∑–∫–∏–π (Minor)</td>
                <td>–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏, –ø–ª–∞–Ω–æ–≤–∞—è –∑–∞–º–µ–Ω–∞, "–•–æ—Ç–µ–ª–∫–∏".</td>
                <td>8 —á–∞—Å–æ–≤</td>
                <td>5 –¥–Ω–µ–π</td>
            </tr>
        </table>

        <table>
            <tr><th width="30%">–ó–∞–¥–∞—á–∞</th><th>–î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π</th><th width="15%">–°—Ä–æ–∫</th></tr>
            <tr>
                <td><strong>2.1. –û–Ω–±–æ—Ä–¥–∏–Ω–≥/–û—Ñ—Ñ–±–æ—Ä–¥–∏–Ω–≥</strong></td>
                <td>–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —á–µ–∫-–ª–∏—Å—Ç—ã —Å HR. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫ –≤ —Ç—Ä–µ–∫–µ—Ä–µ.</td>
                <td>–ú–µ—Å—è—Ü 2</td>
            </tr>
            <tr>
                <td><strong>2.2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¢—Ä–µ–∫–µ—Ä–∞</strong></td>
                <td>–í–Ω–µ–¥—Ä–∏—Ç—å SLA –ø–æ —Ç–∞–±–ª–∏—Ü–µ –≤—ã—à–µ. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ-–æ—Ç–≤–µ—Ç—ã —Ä–æ–±–æ—Ç–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏.</td>
                <td>–ú–µ—Å—è—Ü 3</td>
            </tr>
            <tr>
                <td><strong>2.3. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ KPI</strong></td>
                <td>–£—Ç–≤–µ—Ä–¥–∏—Ç—å –¥–æ–ª–∂–Ω–æ—Å—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏. –í–≤–µ—Å—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏: SLA, FCR, Incidents Rate.</td>
                <td>–ú–µ—Å—è—Ü 3</td>
            </tr>
            <tr>
                <td><strong>2.4. –ë–∞–∑–∞ –ó–Ω–∞–Ω–∏–π</strong></td>
                <td>–í—ã–±—Ä–∞—Ç—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—É. –û–ø–∏—Å–∞—Ç—å –¢–û–ü-10 –ø—Ä–æ–±–ª–µ–º. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å "–†–µ—à–∏–ª ‚Äî –û–ø–∏—Å–∞–ª".</td>
                <td>–ú–µ—Å—è—Ü—ã 3-4</td>
            </tr>
        </table>
    </div>

    <div class="phase-card">
        <div class="phase-header"><div class="phase-title">–≠—Ç–∞–ø 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –†–∞–∑–≤–∏—Ç–∏–µ</div><div class="phase-meta">–ú–µ—Å—è—Ü—ã 4-6</div></div>
        <table>
            <tr><th width="30%">–ó–∞–¥–∞—á–∞</th><th>–î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π</th><th width="15%">–°—Ä–æ–∫</th></tr>
            <tr>
                <td><strong>3.1. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è</strong></td>
                <td>–ó–∞–∫—Ä–µ–ø–∏—Ç—å –∑–æ–Ω—ã —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—ã: –Ø–Ω–¥–µ–∫—Å 360, –°–µ—Ç–∏/VPN, –ñ–µ–ª–µ–∑–æ. –†–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ç–∏–∫–µ—Ç—ã –ø–æ –Ω–∞–≤—ã–∫–∞–º.</td>
                <td>–ú–µ—Å—è—Ü 4</td>
            </tr>
            <tr>
                <td><strong>3.2. –†–µ–≥—É–ª—è—Ä–Ω—ã–π –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç</strong></td>
                <td>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —Å—Ç–µ–Ω–¥–∞–ø—ã (15 –º–∏–Ω), –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã. –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã.</td>
                <td>–ú–µ—Å—è—Ü 5</td>
            </tr>
            <tr>
                <td><strong>3.3. –ö–∞—Ä—å–µ—Ä–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</strong></td>
                <td>–ü—Ä–æ–≤–µ—Å—Ç–∏ Performance Review. –°–æ—Å—Ç–∞–≤–∏—Ç—å –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –ø–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è (–ò–ü–†) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ.</td>
                <td>–ú–µ—Å—è—Ü 6</td>
            </tr>
        </table>
    </div>

    <h2 class="section-title">3. –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω –û–ö–† (–ò—Å–ø—ã—Ç–∞—Ç–µ–ª—å–Ω—ã–π —Å—Ä–æ–∫)</h2>
    <div class="okr-grid">
        <div class="okr-box" data-id="email">
            <h3>üìß –û–ö–† 1: –†–∞—Å—Å—ã–ª–∫–∏</h3>
            <ul class="steps-list">
                <li><strong>–ê—É–¥–∏—Ç (–ù1-2):</strong> –í—ã–≥—Ä—É–∑–∏—Ç—å –≥—Ä—É–ø–ø—ã. –ü–æ–º–µ—Ç–∏—Ç—å "–º–µ—Ä—Ç–≤—ã–µ" –∏ "—Ç–æ–∫—Å–∏—á–Ω—ã–µ".</li>
                <li><strong>–†–µ–≥–ª–∞–º–µ–Ω—Ç (–ù3-4):</strong> –£—Ç–≤–µ—Ä–¥–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –∏ –Ω–µ–π–º–∏–Ω–≥.</li>
                <li><strong>–ß–∏—Å—Ç–∫–∞ (–ù5-6):</strong> –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä–æ–µ, –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –≥—Ä—É–ø–ø—ã.</li>
            </ul>
            <div class="file-zone">
                <strong>üìé –§–∞–π–ª—ã:</strong><ul class="file-list" id="list-email"></ul>
                <div class="upload-controls admin-only"><input type="file" id="file-email"><button class="upload-btn" onclick="uploadFile('email')">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button></div>
            </div>
        </div>

        <div class="okr-box" data-id="contacts">
            <h3>üë§ –û–ö–† 2: –ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
            <ul class="steps-list">
                <li><strong>–†–µ–≤–∏–∑–∏—è (–ù2):</strong> –ü–æ–∏—Å–∫ –¥—É–±–ª–µ–π —Å–∫—Ä–∏–ø—Ç–æ–º. –°–≤–µ—Ä–∫–∞ —Å HR.</li>
                <li><strong>–°—Ç–∞–Ω–¥–∞—Ä—Ç (–ù3):</strong> –£—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–ª—è (–§–æ—Ç–æ, –§–ò–û, –û—Ç–¥–µ–ª, –ú–æ–±.).</li>
                <li><strong>–í–Ω–µ–¥—Ä–µ–Ω–∏–µ (–ù4-5):</strong> –ú–∞—Å—Å–æ–≤–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ.</li>
            </ul>
            <div class="file-zone">
                <strong>üìé –§–∞–π–ª—ã:</strong><ul class="file-list" id="list-contacts"></ul>
                <div class="upload-controls admin-only"><input type="file" id="file-contacts"><button class="upload-btn" onclick="uploadFile('contacts')">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button></div>
            </div>
        </div>

        <div class="okr-box" data-id="onboarding">
            <h3>üîÑ –û–ö–† 3: –ü—Ä–æ—Ü–µ—Å—Å—ã</h3>
            <ul class="steps-list">
                <li><strong>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è (–ù3):</strong> –í—Å—Ç—Ä–µ—á–∞ —Å HR. –í—ã—è–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä—ã–≤–æ–≤.</li>
                <li><strong>–ß–µ–∫-–ª–∏—Å—Ç—ã (–ù4-6):</strong> –ú–∞—Å—Ç–µ—Ä-—Å–ø–∏—Å–∫–∏ –í—Ö–æ–¥–∞/–í—ã—Ö–æ–¥–∞. Kill-switch.</li>
                <li><strong>–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (–ù7-8):</strong> –®–∞–±–ª–æ–Ω—ã –∑–∞–¥–∞—á –≤ Tracker.</li>
            </ul>
            <div class="file-zone">
                <strong>üìé –§–∞–π–ª—ã:</strong><ul class="file-list" id="list-onboarding"></ul>
                <div class="upload-controls admin-only"><input type="file" id="file-onboarding"><button class="upload-btn" onclick="uploadFile('onboarding')">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button></div>
            </div>
        </div>

        <div class="okr-box" data-id="knowledge">
            <h3>üìö –û–ö–† 4: –ë–∞–∑–∞ –ó–Ω–∞–Ω–∏–π</h3>
            <ul class="steps-list">
                <li><strong>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ (–ù1-2):</strong> –í—ã–±–æ—Ä (Notion/Wiki). –ê—É–¥–∏—Ç.</li>
                <li><strong>–ó–æ–ª–æ—Ç–æ–π —Ñ–æ–Ω–¥ (–ù3-5):</strong> –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –¢–û–ü-10 –ø—Ä–æ–±–ª–µ–º.</li>
                <li><strong>–ú–µ—Ç–æ–¥–∏–∫–∞ (–ù6+):</strong> –ü—Ä–∞–≤–∏–ª–æ ¬´–†–µ—à–∏–ª —Ç–∏–∫–µ—Ç ‚Äî –Ω–∞–ø–∏—à–∏ —Å—Ç–∞—Ç—å—é¬ª.</li>
            </ul>
            <div class="file-zone">
                <strong>üìé –§–∞–π–ª—ã:</strong><ul class="file-list" id="list-knowledge"></ul>
                <div class="upload-controls admin-only"><input type="file" id="file-knowledge"><button class="upload-btn" onclick="uploadFile('knowledge')">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button></div>
            </div>
        </div>
    </div>
</div>

<div class="modal-overlay" id="metricsModal">
    <div class="modal">
        <h2>–û–±–Ω–æ–≤–∏—Ç—å –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h2>
        <div class="form-grid">
            <div class="form-group"><label>–û—Ç–∫—Ä—ã—Ç—ã–µ –∑–∞—è–≤–∫–∏</label><input type="text" id="inp-tickets"></div>
            <div class="form-group"><label>SLA (%)</label><input type="text" id="inp-sla"></div>
            <div class="form-group"><label>CSAT (–û—Ü–µ–Ω–∫–∞)</label><input type="text" id="inp-csat"></div>
            <div class="form-group"><label>–°—Ä. –≤—Ä–µ–º—è</label><input type="text" id="inp-time"></div>
            <div class="form-group"><label>FCR (%)</label><input type="text" id="inp-fcr"></div>
            <div class="form-group"><label>–ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã (%)</label><input type="text" id="inp-incidents"></div>
        </div>
        <div class="modal-actions">
            <button class="btn-cancel" onclick="closeMetricsModal()">–û—Ç–º–µ–Ω–∞</button>
            <button class="btn-save" onclick="saveMetrics()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>
</div>

<script>
    const OKR_IDS = ['email', 'contacts', 'onboarding', 'knowledge'];

    document.addEventListener('DOMContentLoaded', () => {
        OKR_IDS.forEach(id => loadFiles(id));
        loadMetrics(); 
        if (localStorage.getItem('isAdmin') === 'true') {
            document.body.classList.add('is-admin');
        }
    });

    // --- METRICS ---
    async function loadMetrics() {
        try {
            const res = await fetch('/api/metrics');
            const data = await res.json();
            
            document.getElementById('val-tickets').innerText = data.open_tickets || "-";
            document.getElementById('val-sla').innerText = data.sla || "-";
            document.getElementById('val-csat').innerText = data.csat || "-";
            document.getElementById('val-time').innerText = data.avg_time || "-";
            document.getElementById('val-fcr').innerText = data.fcr || "-";
            document.getElementById('val-incidents').innerText = data.incidents || "-";
            
            document.querySelectorAll('.val-date').forEach(el => el.innerText = data.last_updated || "-");
        } catch(e) { console.error(e); }
    }

    function openMetricsModal() {
        document.getElementById('inp-tickets').value = document.getElementById('val-tickets').innerText;
        document.getElementById('inp-sla').value = document.getElementById('val-sla').innerText;
        document.getElementById('inp-csat').value = document.getElementById('val-csat').innerText;
        document.getElementById('inp-time').value = document.getElementById('val-time').innerText;
        document.getElementById('inp-fcr').value = document.getElementById('val-fcr').innerText;
        document.getElementById('inp-incidents').value = document.getElementById('val-incidents').innerText;
        document.getElementById('metricsModal').style.display = 'flex';
    }

    function closeMetricsModal() { document.getElementById('metricsModal').style.display = 'none'; }

    async function saveMetrics() {
        const data = {
            open_tickets: document.getElementById('inp-tickets').value,
            sla: document.getElementById('inp-sla').value,
            csat: document.getElementById('inp-csat').value,
            avg_time: document.getElementById('inp-time').value,
            fcr: document.getElementById('inp-fcr').value,
            incidents: document.getElementById('inp-incidents').value,
        };
        try {
            const res = await fetch('/admin/metrics', {
                method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data)
            });
            if (res.ok) { closeMetricsModal(); loadMetrics(); } 
            else if (res.status === 401) { logoutAdmin(); }
        } catch(e) { alert("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏"); }
    }

    // --- AUTH & FILES ---
    async function loginAdmin() {
        try {
            const res = await fetch('/admin/check');
            if (res.ok) {
                localStorage.setItem('isAdmin', 'true');
                document.body.classList.add('is-admin');
                OKR_IDS.forEach(id => loadFiles(id)); 
            } else { alert("–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞"); }
        } catch (e) { console.error(e); }
    }

    async function logoutAdmin() {
        localStorage.removeItem('isAdmin');
        document.body.classList.remove('is-admin');
        try { await fetch('/admin/check', { headers: { 'Authorization': 'Basic ' + btoa('logout:logout') } }); } catch (e) {}
        window.location.reload();
    }

    async function loadFiles(okrId) {
        try {
            const res = await fetch(`/api/files/${okrId}`);
            const data = await res.json();
            const list = document.getElementById(`list-${okrId}`);
            list.innerHTML = '';
            if (data.files && data.files.length > 0) {
                data.files.forEach(file => {
                    const li = document.createElement('li');
                    li.innerHTML = `<a href="${file.url}" target="_blank">üìÑ ${file.name}</a>`;
                    const delBtn = document.createElement('span');
                    delBtn.innerHTML = "&times;";
                    delBtn.className = "delete-btn";
                    delBtn.onclick = () => deleteFile(okrId, file.name);
                    li.appendChild(delBtn);
                    list.appendChild(li);
                });
            } else { list.innerHTML = '<li style="color:#94a3b8;border:none;">–ù–µ—Ç —Ñ–∞–π–ª–æ–≤</li>'; }
        } catch (e) {}
    }

    async function uploadFile(okrId) {
        const input = document.getElementById(`file-${okrId}`);
        if (!input.files.length) return alert("–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω");
        const formData = new FormData();
        formData.append("file", input.files[0]);
        const btn = input.nextElementSibling;
        const oldText = btn.innerText; btn.innerText = "‚è≥"; btn.disabled = true;
        try {
            const res = await fetch(`/admin/upload/${okrId}`, { method: 'POST', body: formData });
            if (res.ok) { input.value = ''; loadFiles(okrId); } 
            else if (res.status === 401) { logoutAdmin(); }
        } catch (e) {}
        finally { btn.innerText = oldText; btn.disabled = false; }
    }

    async function deleteFile(okrId, filename) {
        if (!confirm(`–£–¥–∞–ª–∏—Ç—å ${filename}?`)) return;
        try {
            const res = await fetch(`/admin/delete/${okrId}/${filename}`, { method: 'DELETE' });
            if (res.ok) { loadFiles(okrId); } else if (res.status === 401) { logoutAdmin(); }
        } catch (e) {}
    }
</script>

</body>
</html>